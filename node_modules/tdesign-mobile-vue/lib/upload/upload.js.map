{"version":3,"file":"upload.js","sources":["../../src/upload/upload.vue","../../src/upload/upload.vue?vue&type=template&id=89b3fa2e&lang.js"],"sourcesContent":["<template>\n  <div>\n    <ul :class=\"`${UPLOAD_NAME}__card`\">\n      <li v-for=\"(file, index) in uploadedFiles\" :key=\"index\" :class=\"`${UPLOAD_NAME}__card-item`\" :style=\"itemStyle\">\n        <div :class=\"`${UPLOAD_NAME}__card-content ${UPLOAD_NAME}__card-box`\" :style=\"itemContentStyle\">\n          <div\n            key=\"delete-icon\"\n            :class=\"`${UPLOAD_NAME}__card-delete-item`\"\n            @click=\"(e) => handleRemove(e, file, index)\"\n          >\n            <template v-if=\"deleteBtnContent\">\n              <t-node :content=\"deleteBtnContent\"></t-node>\n            </template>\n            <template v-else>\n              <close-icon class=\"close-icon\" />\n            </template>\n          </div>\n          <img :class=\"`${UPLOAD_NAME}__card-image`\" :src=\"file.url\" @click=\"(e) => handlePreview(e, file)\" />\n          <!--上传失败时，reload重试-->\n          <div v-if=\"file.status === 'fail'\" :class=\"`${UPLOAD_NAME}__card-mask`\">\n            <span key=\"refresh-icon\" :class=\"`${UPLOAD_NAME}__card-mask-item`\">\n              <refresh-icon @click=\"handleReload(file)\" />\n            </span>\n          </div>\n        </div>\n      </li>\n      <template v-if=\"defaultContent\">\n        <div @click=\"triggerUpload\">\n          <t-node :content=\"defaultContent\"></t-node>\n        </div>\n      </template>\n      <template v-else>\n        <li :class=\"`${UPLOAD_NAME}__card-item`\" @click=\"triggerUpload\">\n          <div :class=\"`${UPLOAD_NAME}__card-container ${UPLOAD_NAME}__card-box`\">\n            <add-icon></add-icon>\n          </div>\n        </li>\n      </template>\n    </ul>\n    <input\n      ref=\"inputRef\"\n      :value=\"files\"\n      type=\"file\"\n      :multiple=\"multiple\"\n      hidden\n      :accept=\"accept\"\n      @change=\"handleChange\"\n    />\n    <t-image-viewer v-model:images=\"images\" v-model=\"showViewer\" :initial-index=\"initialIndex\"></t-image-viewer>\n  </div>\n</template>\n<script lang=\"ts\">\nimport { defineComponent, SetupContext, getCurrentInstance, ref, Ref, toRefs, computed, ComputedRef } from 'vue';\nimport { AddIcon, CloseIcon, RefreshIcon } from 'tdesign-icons-vue-next';\nimport findIndex from 'lodash/findIndex';\nimport isObject from 'lodash/isObject';\nimport isFunction from 'lodash/isFunction';\n\nimport xhr from '../_common/js/upload/xhr';\nimport { useDefault, useEmitEvent, renderTNode, TNode } from '../shared';\nimport { TdUploadProps, UploadFile, RequestMethodResponse, SizeLimitObj } from './type';\nimport { SuccessContext, InnerProgressContext } from './interface';\nimport UploadProps from './props';\nimport config from '../config';\nimport { isOverSizeLimit } from './util';\nimport TImageViewer from '../image-viewer';\n\nconst { prefix } = config;\nconst name = `${prefix}-upload`;\nconst { isArray } = Array;\n\nexport default defineComponent({\n  name,\n  components: {\n    AddIcon,\n    TNode,\n    CloseIcon,\n    RefreshIcon,\n    TImageViewer,\n  },\n  props: UploadProps,\n  emits: [\n    'update:files',\n    'update:modelValue',\n    'change',\n    'fail',\n    'preview',\n    'progress',\n    'remove',\n    'success',\n    'select-change',\n  ],\n  setup(props, context: SetupContext) {\n    const emitEvent = useEmitEvent(props, context.emit);\n    const [innerFiles, setInnerFiles] = useDefault<TdUploadProps['files'], TdUploadProps>(\n      props,\n      context.emit,\n      'files',\n      'change',\n    );\n    const internalInstance = getCurrentInstance();\n    const defaultContent = computed(() => renderTNode(internalInstance, 'default'));\n    const deleteBtnContent = computed(() => renderTNode(internalInstance, 'deleteBtn'));\n    const images: Ref<Array<string>> = ref([]);\n    const showViewer = ref(false);\n    const initialIndex = ref(0);\n    const UPLOAD_NAME = name;\n    const xhrReq = ref<XMLHttpRequest | null>(null);\n    // 等待上传的文件\n    const toUploadFiles: Ref<Array<UploadFile>> = ref([]);\n    // 上传成功的文件\n    const uploadedFiles: ComputedRef<UploadFile[]> = computed(() => {\n      if (innerFiles.value && isArray(innerFiles.value)) {\n        // 上传失败的文件用localUrl展示，并且可上传重试\n        return innerFiles.value;\n      }\n      return [];\n    });\n    const errorMsg = ref('');\n    const inputRef = ref<null | HTMLInputElement>(null);\n\n    const itemStyle = computed(() => {\n      const { gridConfig } = toRefs(props);\n      let column = 4;\n      if (isObject(gridConfig.value)) {\n        ({ column } = gridConfig.value as any);\n      }\n      return {\n        flexBasis: `${100 / +column}%`,\n      };\n    });\n\n    const itemContentStyle = computed(() => {\n      let width = 80;\n      let height = 80;\n      const { gridConfig } = toRefs(props);\n      if (isObject(gridConfig.value)) {\n        ({ width, height } = gridConfig.value as any);\n      }\n      return {\n        height: `${height}px`,\n        width: `${width}px`,\n      };\n    });\n\n    const triggerUpload = () => {\n      const input = inputRef.value as HTMLInputElement;\n      if (props.disabled) return;\n      input.click();\n    };\n\n    const handlePreview = (e: MouseEvent, file: UploadFile) => {\n      showViewer.value = true;\n      emitEvent('preview', {\n        e,\n        file,\n      });\n    };\n\n    const handleReload = (file: UploadFile) => {\n      uploadFiles([file.fileRaw]);\n    };\n\n    const handleChange = () => {\n      const input = inputRef.value;\n      if (props.disabled || !input || !input.files) return;\n      const formatFiles = formatFileToUploadFile(input.files);\n      emitEvent('select-change', [...formatFiles]);\n      uploadFiles(formatFiles);\n      input.value = '';\n    };\n\n    const formatFileToUploadFile = (files: FileList): File[] => {\n      const { format } = props;\n      if (!format || !isFunction(format)) {\n        const res = [];\n        for (let i = 0; i < files.length; i++) {\n          res.push(files[i]);\n        }\n        return res;\n      }\n\n      const NewFiles = [...files];\n      NewFiles.forEach((item) => {\n        item = format(item) as any;\n      });\n      return NewFiles;\n    };\n\n    const handleBeforeUpload = (file: File | UploadFile): Promise<boolean> => {\n      if (props.beforeUpload && isFunction(props.beforeUpload)) {\n        const beforeUpload = props.beforeUpload(file);\n        if (beforeUpload instanceof Promise) return beforeUpload;\n        return Promise.resolve(beforeUpload);\n      }\n      return new Promise((resolve) => {\n        if (props.sizeLimit) {\n          resolve(handleSizeLimit(file.size));\n        }\n        resolve(true);\n      });\n    };\n\n    const handleSizeLimit = (fileSize: number) => {\n      let sizeLimit: SizeLimitObj;\n      if (typeof props.sizeLimit === 'number') {\n        sizeLimit = { size: props.sizeLimit, unit: 'KB' };\n      } else if (typeof props.sizeLimit === 'object') {\n        sizeLimit = props.sizeLimit;\n      } else {\n        sizeLimit = { size: 0, unit: 'KB' };\n      }\n      const isOverSize = isOverSizeLimit(fileSize, sizeLimit.size, sizeLimit.unit);\n      if (isOverSize) {\n        errorMsg.value = sizeLimit.message\n          ? sizeLimit.message\n          : `TDesign Upoad Error: uploaded picture exceeds ${props.sizeLimit}${sizeLimit.unit} restrictions`;\n      }\n      return isOverSize;\n    };\n\n    const uploadFiles = (files: File[]) => {\n      const { max } = toRefs(props);\n      let tmpFiles = [...files];\n      if (max.value) {\n        tmpFiles = tmpFiles.slice(0, max.value - uploadedFiles.value.length);\n        if (tmpFiles.length !== files.length) {\n          console.warn(`TDesign Upload Warn: you can only upload ${max.value} files`);\n        }\n      }\n      tmpFiles.forEach((fileRaw: any) => {\n        const uploadFile: UploadFile = {\n          ...fileRaw,\n          fileRaw,\n          lastModified: fileRaw.lastModified,\n          name: fileRaw.name,\n          size: fileRaw.size,\n          type: fileRaw.type,\n          percent: 0,\n          status: 'waiting',\n        };\n        const reader = new FileReader();\n        reader.readAsDataURL(fileRaw);\n        reader.onload = (event: ProgressEvent<FileReader>) => {\n          uploadFile.url = event.target?.result as string;\n        };\n        handleBeforeUpload(fileRaw).then((canUpload) => {\n          if (!canUpload) return;\n          const newFiles: Array<UploadFile> = toUploadFiles.value.concat();\n\n          // 判断是否为重复文件条件，已选是否存在检验\n          if (props.allowUploadDuplicateFile || !toUploadFiles.value.find((file) => file.name === uploadFile.name)) {\n            newFiles.push(uploadFile);\n          }\n          toUploadFiles.value = newFiles;\n          if (props.autoUpload) {\n            upload(uploadFile);\n          }\n        });\n      });\n    };\n\n    /** 模拟进度条 Mock Progress */\n    const handleMockProgress = (file: UploadFile) => {\n      const timer = setInterval(() => {\n        if (file.status === 'success' || file.percent >= 99) {\n          clearInterval(timer);\n          return;\n        }\n        file.percent += 1;\n        handleProgress({\n          file,\n          percent: file.percent,\n          type: 'mock',\n        });\n      }, 10);\n    };\n\n    const handleProgress = ({ event, file, percent, type = 'real' }: InnerProgressContext) => {\n      if (!file) throw new Error('Error file');\n      file.percent = Math.min(percent, 100);\n      const progressCtx = {\n        percent,\n        e: event,\n        file,\n        type,\n      };\n      emitEvent('progress', progressCtx);\n    };\n\n    const handleRemove = (e: MouseEvent, file: UploadFile, index: number) => {\n      errorMsg.value = '';\n      const files = uploadedFiles.value.concat();\n      files.splice(index, 1);\n      setInnerFiles(files, { e, trigger: 'remove', index, file });\n      emitEvent('remove', { e, index, file });\n      images.value.splice(index, 1);\n    };\n\n    const upload = async (file: UploadFile): Promise<void> => {\n      if (!props.action && !props.requestMethod) {\n        console.error('TDesign Upload Error: one of action and requestMethod must be exist.');\n        return;\n      }\n      errorMsg.value = '';\n      file.status = 'progress';\n      // requestMethod 为父组件定义的自定义上传方法\n      if (props.requestMethod) {\n        handleRequestMethod(file);\n      } else {\n        // 模拟进度条\n        if (props.useMockProgress) {\n          handleMockProgress(file);\n        }\n        const request = xhr;\n        xhrReq.value = request({\n          action: props.action,\n          data: {\n            file: file.fileRaw,\n            ...props.data,\n          },\n          file,\n          method: props.method,\n          headers: props.headers || {},\n          withCredentials: props.withCredentials,\n          onError: handleError,\n          onProgress: handleProgress,\n          onSuccess: handleSuccess,\n        } as any);\n      }\n    };\n\n    const handleRequestMethod = (file: UploadFile) => {\n      if (!isFunction(props.requestMethod)) {\n        console.warn('TDesign Upload Warn: `requestMethod` must be a function.');\n        return;\n      }\n      props.requestMethod?.(file).then((res: RequestMethodResponse) => {\n        if (!handleRequestMethodResponse(res)) return;\n        if (res.status === 'success') {\n          handleSuccess({ file, response: res.response });\n        } else if (res.status === 'fail') {\n          const r = res.response || {};\n          handleError({ event: undefined, file, response: { ...r, error: res.error } });\n        }\n      });\n    };\n\n    const handleRequestMethodResponse = (res: RequestMethodResponse) => {\n      if (!res) {\n        console.error('TDesign Upoad Error: `requestMethodResponse` is required.');\n        return false;\n      }\n      if (!res.status) {\n        console.error(\n          'TDesign Upoad Error: `requestMethodResponse.status` is missing, which value is `success` or `fail`',\n        );\n        return false;\n      }\n      if (!['success', 'fail'].includes(res.status)) {\n        console.error('TDesign Upoad Error: `requestMethodResponse.status` must be `success` or `fail`');\n        return false;\n      }\n      if (res.status === 'success' && (!res.response || !res.response.url)) {\n        console.warn(\n          'TDesign Upoad Warn: `requestMethodResponse.response.url` is required, when `status` is `success`',\n        );\n      }\n      return true;\n    };\n\n    const handleSuccess = ({ event, file, response }: SuccessContext) => {\n      if (!file) throw new Error('Error file');\n      file.status = 'success';\n      let res = response;\n      if (props.formatResponse && isFunction(props.formatResponse)) {\n        res = props.formatResponse(response, { file: file as UploadFile });\n      }\n      // 如果返回值存在 error，则认为当前接口上传失败\n      if (res?.error) {\n        handleError({\n          event,\n          file: file as UploadFile,\n          response: res,\n          resFormatted: true,\n        });\n        return;\n      }\n      file.url = res?.url || file.url;\n      // 从待上传文件队列中移除上传成功的文件\n      const index = findIndex(toUploadFiles.value, (o: UploadFile) => o.name === file.name);\n      toUploadFiles.value.splice(index, 1);\n      // 上传成功的文件发送到 files\n      const newFile = { ...file, response: res };\n      const files = uploadedFiles.value.concat(newFile as UploadFile);\n      setInnerFiles(files, { e: event, response: res, trigger: 'upload-success' });\n      emitEvent('success', {\n        file,\n        fileList: files,\n        e: event,\n        response: res,\n      });\n      images.value.push(newFile.url as string);\n    };\n\n    const handleError = (options: {\n      event?: ProgressEvent;\n      file: UploadFile;\n      response?: any;\n      resFormatted?: boolean;\n    }) => {\n      const { event, file, response, resFormatted } = options;\n      file.status = 'fail';\n      let res = response;\n      if (!resFormatted && props.formatResponse && isFunction(props.formatResponse)) {\n        res = props.formatResponse(response, { file });\n      }\n      errorMsg.value = res?.error;\n      if (\n        !uploadedFiles.value.find((item) => {\n          return item.name === file.name;\n        })\n      ) {\n        const files = uploadedFiles.value.concat(file);\n        setInnerFiles(files, { e: event, response: res, trigger: 'upload-fail' });\n      }\n      emitEvent('fail', { e: event, file });\n    };\n\n    return {\n      ...toRefs(props),\n      UPLOAD_NAME,\n      images,\n      showViewer,\n      initialIndex,\n      prefix,\n      innerFiles,\n      xhrReq,\n      toUploadFiles,\n      errorMsg,\n      inputRef,\n      uploadedFiles,\n      deleteBtnContent,\n      defaultContent,\n      itemStyle,\n      itemContentStyle,\n      emitEvent,\n      setInnerFiles,\n      triggerUpload,\n      handleChange,\n      handlePreview,\n      handleReload,\n      handleBeforeUpload,\n      handleSizeLimit,\n      uploadFiles,\n      handleMockProgress,\n      handleProgress,\n      handleRemove,\n      upload,\n      handleRequestMethodResponse,\n      handleSuccess,\n      handleError,\n    };\n  },\n});\n</script>\n","<template>\n  <div>\n    <ul :class=\"`${UPLOAD_NAME}__card`\">\n      <li v-for=\"(file, index) in uploadedFiles\" :key=\"index\" :class=\"`${UPLOAD_NAME}__card-item`\" :style=\"itemStyle\">\n        <div :class=\"`${UPLOAD_NAME}__card-content ${UPLOAD_NAME}__card-box`\" :style=\"itemContentStyle\">\n          <div\n            key=\"delete-icon\"\n            :class=\"`${UPLOAD_NAME}__card-delete-item`\"\n            @click=\"(e) => handleRemove(e, file, index)\"\n          >\n            <template v-if=\"deleteBtnContent\">\n              <t-node :content=\"deleteBtnContent\"></t-node>\n            </template>\n            <template v-else>\n              <close-icon class=\"close-icon\" />\n            </template>\n          </div>\n          <img :class=\"`${UPLOAD_NAME}__card-image`\" :src=\"file.url\" @click=\"(e) => handlePreview(e, file)\" />\n          <!--上传失败时，reload重试-->\n          <div v-if=\"file.status === 'fail'\" :class=\"`${UPLOAD_NAME}__card-mask`\">\n            <span key=\"refresh-icon\" :class=\"`${UPLOAD_NAME}__card-mask-item`\">\n              <refresh-icon @click=\"handleReload(file)\" />\n            </span>\n          </div>\n        </div>\n      </li>\n      <template v-if=\"defaultContent\">\n        <div @click=\"triggerUpload\">\n          <t-node :content=\"defaultContent\"></t-node>\n        </div>\n      </template>\n      <template v-else>\n        <li :class=\"`${UPLOAD_NAME}__card-item`\" @click=\"triggerUpload\">\n          <div :class=\"`${UPLOAD_NAME}__card-container ${UPLOAD_NAME}__card-box`\">\n            <add-icon></add-icon>\n          </div>\n        </li>\n      </template>\n    </ul>\n    <input\n      ref=\"inputRef\"\n      :value=\"files\"\n      type=\"file\"\n      :multiple=\"multiple\"\n      hidden\n      :accept=\"accept\"\n      @change=\"handleChange\"\n    />\n    <t-image-viewer v-model:images=\"images\" v-model=\"showViewer\" :initial-index=\"initialIndex\"></t-image-viewer>\n  </div>\n</template>\n<script lang=\"ts\">\nimport { defineComponent, SetupContext, getCurrentInstance, ref, Ref, toRefs, computed, ComputedRef } from 'vue';\nimport { AddIcon, CloseIcon, RefreshIcon } from 'tdesign-icons-vue-next';\nimport findIndex from 'lodash/findIndex';\nimport isObject from 'lodash/isObject';\nimport isFunction from 'lodash/isFunction';\n\nimport xhr from '../_common/js/upload/xhr';\nimport { useDefault, useEmitEvent, renderTNode, TNode } from '../shared';\nimport { TdUploadProps, UploadFile, RequestMethodResponse, SizeLimitObj } from './type';\nimport { SuccessContext, InnerProgressContext } from './interface';\nimport UploadProps from './props';\nimport config from '../config';\nimport { isOverSizeLimit } from './util';\nimport TImageViewer from '../image-viewer';\n\nconst { prefix } = config;\nconst name = `${prefix}-upload`;\nconst { isArray } = Array;\n\nexport default defineComponent({\n  name,\n  components: {\n    AddIcon,\n    TNode,\n    CloseIcon,\n    RefreshIcon,\n    TImageViewer,\n  },\n  props: UploadProps,\n  emits: [\n    'update:files',\n    'update:modelValue',\n    'change',\n    'fail',\n    'preview',\n    'progress',\n    'remove',\n    'success',\n    'select-change',\n  ],\n  setup(props, context: SetupContext) {\n    const emitEvent = useEmitEvent(props, context.emit);\n    const [innerFiles, setInnerFiles] = useDefault<TdUploadProps['files'], TdUploadProps>(\n      props,\n      context.emit,\n      'files',\n      'change',\n    );\n    const internalInstance = getCurrentInstance();\n    const defaultContent = computed(() => renderTNode(internalInstance, 'default'));\n    const deleteBtnContent = computed(() => renderTNode(internalInstance, 'deleteBtn'));\n    const images: Ref<Array<string>> = ref([]);\n    const showViewer = ref(false);\n    const initialIndex = ref(0);\n    const UPLOAD_NAME = name;\n    const xhrReq = ref<XMLHttpRequest | null>(null);\n    // 等待上传的文件\n    const toUploadFiles: Ref<Array<UploadFile>> = ref([]);\n    // 上传成功的文件\n    const uploadedFiles: ComputedRef<UploadFile[]> = computed(() => {\n      if (innerFiles.value && isArray(innerFiles.value)) {\n        // 上传失败的文件用localUrl展示，并且可上传重试\n        return innerFiles.value;\n      }\n      return [];\n    });\n    const errorMsg = ref('');\n    const inputRef = ref<null | HTMLInputElement>(null);\n\n    const itemStyle = computed(() => {\n      const { gridConfig } = toRefs(props);\n      let column = 4;\n      if (isObject(gridConfig.value)) {\n        ({ column } = gridConfig.value as any);\n      }\n      return {\n        flexBasis: `${100 / +column}%`,\n      };\n    });\n\n    const itemContentStyle = computed(() => {\n      let width = 80;\n      let height = 80;\n      const { gridConfig } = toRefs(props);\n      if (isObject(gridConfig.value)) {\n        ({ width, height } = gridConfig.value as any);\n      }\n      return {\n        height: `${height}px`,\n        width: `${width}px`,\n      };\n    });\n\n    const triggerUpload = () => {\n      const input = inputRef.value as HTMLInputElement;\n      if (props.disabled) return;\n      input.click();\n    };\n\n    const handlePreview = (e: MouseEvent, file: UploadFile) => {\n      showViewer.value = true;\n      emitEvent('preview', {\n        e,\n        file,\n      });\n    };\n\n    const handleReload = (file: UploadFile) => {\n      uploadFiles([file.fileRaw]);\n    };\n\n    const handleChange = () => {\n      const input = inputRef.value;\n      if (props.disabled || !input || !input.files) return;\n      const formatFiles = formatFileToUploadFile(input.files);\n      emitEvent('select-change', [...formatFiles]);\n      uploadFiles(formatFiles);\n      input.value = '';\n    };\n\n    const formatFileToUploadFile = (files: FileList): File[] => {\n      const { format } = props;\n      if (!format || !isFunction(format)) {\n        const res = [];\n        for (let i = 0; i < files.length; i++) {\n          res.push(files[i]);\n        }\n        return res;\n      }\n\n      const NewFiles = [...files];\n      NewFiles.forEach((item) => {\n        item = format(item) as any;\n      });\n      return NewFiles;\n    };\n\n    const handleBeforeUpload = (file: File | UploadFile): Promise<boolean> => {\n      if (props.beforeUpload && isFunction(props.beforeUpload)) {\n        const beforeUpload = props.beforeUpload(file);\n        if (beforeUpload instanceof Promise) return beforeUpload;\n        return Promise.resolve(beforeUpload);\n      }\n      return new Promise((resolve) => {\n        if (props.sizeLimit) {\n          resolve(handleSizeLimit(file.size));\n        }\n        resolve(true);\n      });\n    };\n\n    const handleSizeLimit = (fileSize: number) => {\n      let sizeLimit: SizeLimitObj;\n      if (typeof props.sizeLimit === 'number') {\n        sizeLimit = { size: props.sizeLimit, unit: 'KB' };\n      } else if (typeof props.sizeLimit === 'object') {\n        sizeLimit = props.sizeLimit;\n      } else {\n        sizeLimit = { size: 0, unit: 'KB' };\n      }\n      const isOverSize = isOverSizeLimit(fileSize, sizeLimit.size, sizeLimit.unit);\n      if (isOverSize) {\n        errorMsg.value = sizeLimit.message\n          ? sizeLimit.message\n          : `TDesign Upoad Error: uploaded picture exceeds ${props.sizeLimit}${sizeLimit.unit} restrictions`;\n      }\n      return isOverSize;\n    };\n\n    const uploadFiles = (files: File[]) => {\n      const { max } = toRefs(props);\n      let tmpFiles = [...files];\n      if (max.value) {\n        tmpFiles = tmpFiles.slice(0, max.value - uploadedFiles.value.length);\n        if (tmpFiles.length !== files.length) {\n          console.warn(`TDesign Upload Warn: you can only upload ${max.value} files`);\n        }\n      }\n      tmpFiles.forEach((fileRaw: any) => {\n        const uploadFile: UploadFile = {\n          ...fileRaw,\n          fileRaw,\n          lastModified: fileRaw.lastModified,\n          name: fileRaw.name,\n          size: fileRaw.size,\n          type: fileRaw.type,\n          percent: 0,\n          status: 'waiting',\n        };\n        const reader = new FileReader();\n        reader.readAsDataURL(fileRaw);\n        reader.onload = (event: ProgressEvent<FileReader>) => {\n          uploadFile.url = event.target?.result as string;\n        };\n        handleBeforeUpload(fileRaw).then((canUpload) => {\n          if (!canUpload) return;\n          const newFiles: Array<UploadFile> = toUploadFiles.value.concat();\n\n          // 判断是否为重复文件条件，已选是否存在检验\n          if (props.allowUploadDuplicateFile || !toUploadFiles.value.find((file) => file.name === uploadFile.name)) {\n            newFiles.push(uploadFile);\n          }\n          toUploadFiles.value = newFiles;\n          if (props.autoUpload) {\n            upload(uploadFile);\n          }\n        });\n      });\n    };\n\n    /** 模拟进度条 Mock Progress */\n    const handleMockProgress = (file: UploadFile) => {\n      const timer = setInterval(() => {\n        if (file.status === 'success' || file.percent >= 99) {\n          clearInterval(timer);\n          return;\n        }\n        file.percent += 1;\n        handleProgress({\n          file,\n          percent: file.percent,\n          type: 'mock',\n        });\n      }, 10);\n    };\n\n    const handleProgress = ({ event, file, percent, type = 'real' }: InnerProgressContext) => {\n      if (!file) throw new Error('Error file');\n      file.percent = Math.min(percent, 100);\n      const progressCtx = {\n        percent,\n        e: event,\n        file,\n        type,\n      };\n      emitEvent('progress', progressCtx);\n    };\n\n    const handleRemove = (e: MouseEvent, file: UploadFile, index: number) => {\n      errorMsg.value = '';\n      const files = uploadedFiles.value.concat();\n      files.splice(index, 1);\n      setInnerFiles(files, { e, trigger: 'remove', index, file });\n      emitEvent('remove', { e, index, file });\n      images.value.splice(index, 1);\n    };\n\n    const upload = async (file: UploadFile): Promise<void> => {\n      if (!props.action && !props.requestMethod) {\n        console.error('TDesign Upload Error: one of action and requestMethod must be exist.');\n        return;\n      }\n      errorMsg.value = '';\n      file.status = 'progress';\n      // requestMethod 为父组件定义的自定义上传方法\n      if (props.requestMethod) {\n        handleRequestMethod(file);\n      } else {\n        // 模拟进度条\n        if (props.useMockProgress) {\n          handleMockProgress(file);\n        }\n        const request = xhr;\n        xhrReq.value = request({\n          action: props.action,\n          data: {\n            file: file.fileRaw,\n            ...props.data,\n          },\n          file,\n          method: props.method,\n          headers: props.headers || {},\n          withCredentials: props.withCredentials,\n          onError: handleError,\n          onProgress: handleProgress,\n          onSuccess: handleSuccess,\n        } as any);\n      }\n    };\n\n    const handleRequestMethod = (file: UploadFile) => {\n      if (!isFunction(props.requestMethod)) {\n        console.warn('TDesign Upload Warn: `requestMethod` must be a function.');\n        return;\n      }\n      props.requestMethod?.(file).then((res: RequestMethodResponse) => {\n        if (!handleRequestMethodResponse(res)) return;\n        if (res.status === 'success') {\n          handleSuccess({ file, response: res.response });\n        } else if (res.status === 'fail') {\n          const r = res.response || {};\n          handleError({ event: undefined, file, response: { ...r, error: res.error } });\n        }\n      });\n    };\n\n    const handleRequestMethodResponse = (res: RequestMethodResponse) => {\n      if (!res) {\n        console.error('TDesign Upoad Error: `requestMethodResponse` is required.');\n        return false;\n      }\n      if (!res.status) {\n        console.error(\n          'TDesign Upoad Error: `requestMethodResponse.status` is missing, which value is `success` or `fail`',\n        );\n        return false;\n      }\n      if (!['success', 'fail'].includes(res.status)) {\n        console.error('TDesign Upoad Error: `requestMethodResponse.status` must be `success` or `fail`');\n        return false;\n      }\n      if (res.status === 'success' && (!res.response || !res.response.url)) {\n        console.warn(\n          'TDesign Upoad Warn: `requestMethodResponse.response.url` is required, when `status` is `success`',\n        );\n      }\n      return true;\n    };\n\n    const handleSuccess = ({ event, file, response }: SuccessContext) => {\n      if (!file) throw new Error('Error file');\n      file.status = 'success';\n      let res = response;\n      if (props.formatResponse && isFunction(props.formatResponse)) {\n        res = props.formatResponse(response, { file: file as UploadFile });\n      }\n      // 如果返回值存在 error，则认为当前接口上传失败\n      if (res?.error) {\n        handleError({\n          event,\n          file: file as UploadFile,\n          response: res,\n          resFormatted: true,\n        });\n        return;\n      }\n      file.url = res?.url || file.url;\n      // 从待上传文件队列中移除上传成功的文件\n      const index = findIndex(toUploadFiles.value, (o: UploadFile) => o.name === file.name);\n      toUploadFiles.value.splice(index, 1);\n      // 上传成功的文件发送到 files\n      const newFile = { ...file, response: res };\n      const files = uploadedFiles.value.concat(newFile as UploadFile);\n      setInnerFiles(files, { e: event, response: res, trigger: 'upload-success' });\n      emitEvent('success', {\n        file,\n        fileList: files,\n        e: event,\n        response: res,\n      });\n      images.value.push(newFile.url as string);\n    };\n\n    const handleError = (options: {\n      event?: ProgressEvent;\n      file: UploadFile;\n      response?: any;\n      resFormatted?: boolean;\n    }) => {\n      const { event, file, response, resFormatted } = options;\n      file.status = 'fail';\n      let res = response;\n      if (!resFormatted && props.formatResponse && isFunction(props.formatResponse)) {\n        res = props.formatResponse(response, { file });\n      }\n      errorMsg.value = res?.error;\n      if (\n        !uploadedFiles.value.find((item) => {\n          return item.name === file.name;\n        })\n      ) {\n        const files = uploadedFiles.value.concat(file);\n        setInnerFiles(files, { e: event, response: res, trigger: 'upload-fail' });\n      }\n      emitEvent('fail', { e: event, file });\n    };\n\n    return {\n      ...toRefs(props),\n      UPLOAD_NAME,\n      images,\n      showViewer,\n      initialIndex,\n      prefix,\n      innerFiles,\n      xhrReq,\n      toUploadFiles,\n      errorMsg,\n      inputRef,\n      uploadedFiles,\n      deleteBtnContent,\n      defaultContent,\n      itemStyle,\n      itemContentStyle,\n      emitEvent,\n      setInnerFiles,\n      triggerUpload,\n      handleChange,\n      handlePreview,\n      handleReload,\n      handleBeforeUpload,\n      handleSizeLimit,\n      uploadFiles,\n      handleMockProgress,\n      handleProgress,\n      handleRemove,\n      upload,\n      handleRequestMethodResponse,\n      handleSuccess,\n      handleError,\n    };\n  },\n});\n</script>\n"],"names":["prefix","config","name","isArray","Array","defineComponent","components","AddIcon","TNode","CloseIcon","RefreshIcon","TImageViewer","props","UploadProps","emits","setup","context","emitEvent","useEmitEvent","emit","useDefault","_slicedToArray","innerFiles","setInnerFiles","internalInstance","getCurrentInstance","defaultContent","computed","renderTNode","deleteBtnContent","images","ref","showViewer","initialIndex","UPLOAD_NAME","xhrReq","toUploadFiles","uploadedFiles","value","errorMsg","inputRef","itemStyle","toRefs","gridConfig","column","isObject","flexBasis","itemContentStyle","width","height","triggerUpload","input","disabled","click","handlePreview","e","file","handleReload","uploadFiles","fileRaw","handleChange","files","formatFiles","formatFileToUploadFile","format","isFunction","res","i","length","push","NewFiles","forEach","item","handleBeforeUpload","beforeUpload","Promise","resolve","sizeLimit","handleSizeLimit","size","fileSize","unit","_typeof","isOverSize","isOverSizeLimit","message","max","tmpFiles","slice","console","warn","uploadFile","lastModified","type","percent","status","reader","FileReader","readAsDataURL","onload","event","url","target","result","then","canUpload","newFiles","concat","allowUploadDuplicateFile","find","autoUpload","upload","handleMockProgress","timer","setInterval","clearInterval","handleProgress","Error","Math","min","progressCtx","handleRemove","index","splice","trigger","_asyncToGenerator","_regeneratorRuntime","action","requestMethod","error","handleRequestMethod","useMockProgress","request","xhr","data","method","headers","withCredentials","onError","handleError","onProgress","onSuccess","handleSuccess","handleRequestMethodResponse","response","r","includes","formatResponse","resFormatted","findIndex","o","newFile","fileList","options","_createElementBlock","_createElementVNode","class","_ctx","_openBlock","_Fragment","_renderList","key","style","_normalizeClass","onClick","_createBlock","_component_t_node","content","_component_close_icon","src","_createVNode","_component_refresh_icon","$event","_component_add_icon","multiple","hidden","accept","onChange","_component_t_image_viewer"],"mappings":"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"}