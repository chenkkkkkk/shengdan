{"ast":null,"code":"/**\n * tdesign v0.14.1\n * (c) 2022 TDesign Group\n * @license MIT\n */\n\nimport { defineComponent, ref, getCurrentInstance, computed, resolveComponent, openBlock, createElementBlock, normalizeClass, createVNode, renderSlot, createElementVNode, withModifiers, createBlock, createCommentVNode } from 'vue';\nimport { useWindowSize, useElementBounding, useEventListener } from '@vueuse/core';\nimport _Loading from '../loading/index.js';\nimport config from '../config.js';\nimport ListProps from './props.js';\nimport '../shared/index.js';\nimport TNodeComponent from '../shared/render-tnode.js';\nimport { useEmitEvent } from '../shared/useEmitEvent/index.js';\nimport { useScrollParent } from '../shared/useScrollParent/index.js';\nimport { renderTNode } from '../shared/render.js';\nimport '../loading/loading.js';\nimport '@babel/runtime/helpers/defineProperty';\nimport '../loading/icon/gradient.js';\nimport '../_common/js/loading/circle-adapter.js';\nimport '../_common/js/utils/set-style.js';\nimport '../_common/js/utils/helper.js';\nimport '@babel/runtime/helpers/toConsumableArray';\nimport '@babel/runtime/helpers/objectWithoutProperties';\nimport '@babel/runtime/helpers/slicedToArray';\nimport '../loading/icon/spinner.js';\nimport '../shared/constants.js';\nimport '../loading/props.js';\nimport './style/css.js';\nimport '../loading/type.js';\nimport '../shared/component.js';\nimport '@babel/runtime/helpers/typeof';\nimport 'lodash/camelCase';\nimport '../shared/functions.js';\nimport '../shared/util.js';\nimport '../shared/useToggle/index.js';\nimport '../shared/useCountDown/index.js';\nimport '@babel/runtime/helpers/asyncToGenerator';\nimport '@babel/runtime/regenerator';\nimport '../shared/useCountDown/utils.js';\nimport '../shared/useDefault/index.js';\nimport '../shared/useChildSlots/index.js';\nimport '../shared/useVModel/index.js';\nimport '../shared/useTouch/index.js';\nimport '../shared/useExpose/index.js';\nimport '../shared/useTest/index.js';\nvar prefix = config.prefix;\nvar name = \"\".concat(prefix, \"-list\");\nvar LOADING_TEXT_MAP = {\n  loading: \"\\u52A0\\u8F7D\\u4E2D...\",\n  \"load-more\": \"\\u70B9\\u51FB\\u52A0\\u8F7D\\u66F4\\u591A\"\n};\nvar script = defineComponent({\n  name: name,\n  components: {\n    TLoading: _Loading,\n    TNode: TNodeComponent\n  },\n  props: ListProps,\n  emits: [\"load-more\", \"scroll\"],\n  setup: function setup(props, context) {\n    var emitEvent = useEmitEvent(props, context.emit);\n    var root = ref();\n    var empty = ref();\n    var scrollParent = useScrollParent(root);\n    var _useWindowSize = useWindowSize(),\n      height = _useWindowSize.height;\n    var internalInstance = getCurrentInstance();\n    var headerContent = computed(function () {\n      return renderTNode(internalInstance, \"header\");\n    });\n    var footerContent = computed(function () {\n      return renderTNode(internalInstance, \"footer\");\n    });\n    var onLoadMore = function onLoadMore(e) {\n      if (props.asyncLoading === \"load-more\") {\n        emitEvent(\"load-more\");\n      }\n    };\n    var handleScroll = function handleScroll(e) {\n      var _useElementBounding = useElementBounding(root),\n        top = _useElementBounding.top;\n      emitEvent(\"scroll\", top.value - height.value, document.documentElement.scrollTop);\n    };\n    useEventListener(scrollParent, \"scroll\", handleScroll);\n    return {\n      name: name,\n      root: root,\n      empty: empty,\n      onLoadMore: onLoadMore,\n      handleScroll: handleScroll,\n      headerContent: headerContent,\n      footerContent: footerContent,\n      LOADING_TEXT_MAP: LOADING_TEXT_MAP\n    };\n  }\n});\nfunction render(_ctx, _cache, $props, $setup, $data, $options) {\n  var _component_t_node = resolveComponent(\"t-node\");\n  var _component_t_loading = resolveComponent(\"t-loading\");\n  return openBlock(), createElementBlock(\"div\", {\n    ref: \"root\",\n    class: normalizeClass(_ctx.name),\n    onScroll: _cache[1] || (_cache[1] = function () {\n      return _ctx.handleScroll && _ctx.handleScroll.apply(_ctx, arguments);\n    })\n  }, [createVNode(_component_t_node, {\n    content: _ctx.headerContent\n  }, null, 8, [\"content\"]), renderSlot(_ctx.$slots, \"default\"), createElementVNode(\"div\", {\n    class: normalizeClass(\"\".concat(_ctx.name, \"__loading--wrapper\")),\n    onClick: _cache[0] || (_cache[0] = withModifiers(function () {\n      return _ctx.onLoadMore && _ctx.onLoadMore.apply(_ctx, arguments);\n    }, [\"stop\"]))\n  }, [typeof _ctx.asyncLoading === \"string\" && [\"loading\", \"load-more\"].includes(_ctx.asyncLoading) ? (openBlock(), createBlock(_component_t_loading, {\n    key: 0,\n    loading: _ctx.asyncLoading === \"loading\",\n    text: typeof _ctx.asyncLoading === \"string\" ? _ctx.LOADING_TEXT_MAP[_ctx.asyncLoading] : \"\",\n    class: normalizeClass(\"\".concat(_ctx.name, \"__loading\"))\n  }, null, 8, [\"loading\", \"text\", \"class\"])) : createCommentVNode(\"\", true)], 2), createVNode(_component_t_node, {\n    content: _ctx.footerContent\n  }, null, 8, [\"content\"])], 34);\n}\nscript.render = render;\nexport { script as default };","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwBA,IAAQA,SAAWC,OAAXD;AACR,IAAME,OAAUF;AAChB,IAAMG,gBAAmB;EACvBC,OAAS;EACT,WAAa;AACf;AAEA,aAAeC,eAAgB;EAC7BH;EACAI,UAAY;IACVC;IACAC;GACF;EACAC,KAAO;EACPC,OAAO,CAAC,aAAa,QAAQ;EAC7BC,OAAMF,sBAAOG,OAAuB;IAClC,IAAMC,SAAY,gBAAaJ,KAAO,UAAQK,IAAI;IAClD,IAAMC,OAAOC,GAAiB;IAC9B,IAAMC,QAAQD,GAAiB;IACzB,mBAAeE,gBAAgBH,IAAI;IACnC,qBAAaI,aAAc;MAAzBC,MAAO,kBAAPA,MAAO;IACf,IAAMC,mBAAmBC,kBAAmB;IAE5C,IAAMC,gBAAgBC,QAAS;MAAA,OAAMC,WAAY,mBAAkB,QAAQ,CAAC;KAAA;IAC5E,IAAMC,gBAAgBF,QAAS;MAAA,OAAMC,WAAY,mBAAkB,QAAQ,CAAC;KAAA;IAEtE,iBAAa,SAAbE,WAAcC,CAAkB;MAChC,UAAMC,iBAAiB,WAAa;QACtChB,UAAU,WAAW;MACvB;KACF;IAEM,mBAAe,SAAfiB,aAAgBF,CAA0B;MAC9C,IAAgBG,yCAAmBhB,IAAI;QAA/BiB;MAERnB,UAAU,UAAUmB,GAAI,SAAQZ,OAAOa,KAAO,WAASC,gBAAgBC,SAAS;KAClF;IAEiBC,+BAAc,UAAUN,YAAY;IAE9C;MACL5B;MACAa;MACAE;MACAU;MACAG;MACAP;MACAG;MACAvB;KACF;EACF;AACF,CAAC;;;;oBC1EC,qBAYK;IAZAa,GAAI;IAAQqB,qBAAO,MAAInC;IAAGoC;aAAQC,KAAYT;IAAA;MACjDU,YAAkCC;IAAzBC,OAAS,OAAanB;GAAA,yBAC/BoB,WAAOJ,yBACPK,mBAOK;IAPCP,gCAAUE,KAAIrC;IAAuB2C;aAAYN,IAAU;KAAA;aAEhDA,KAAaV,qDAAyC,UAASU,KAAYV,8BAD1FiB,YAKCC;;IAHE3C,SAASmC,KAAaV;IACtBmB,MAAa,6BAA4B,iCAAiBT,KAAYV;IACtEQ,sBAAUE,eAAIrC;kFAGnBsC,YAAkCC;IAAzBC,OAAS,OAAahB;EAAA","names":["prefix","config","name","LOADING_TEXT_MAP","loading","defineComponent","components","TLoading","TNode","props","emits","setup","context","emitEvent","emit","root","ref","empty","useScrollParent","useWindowSize","height","internalInstance","getCurrentInstance","headerContent","computed","renderTNode","footerContent","onLoadMore","e","asyncLoading","handleScroll","useElementBounding","top","value","documentElement","scrollTop","useEventListener","class","onScroll","_ctx","_createVNode","_component_t_node","content","_renderSlot","_createElementVNode","onClick","_createBlock","_component_t_loading","text"],"sources":["../../src/list/list.vue","../../src/list/list.vue?vue&type=template&id=27c0a91a&lang.js"],"sourcesContent":["<template>\n  <div ref=\"root\" :class=\"name\" @scroll=\"handleScroll\">\n    <t-node :content=\"headerContent\" />\n    <slot />\n    <div :class=\"`${name}__loading--wrapper`\" @click.stop=\"onLoadMore\">\n      <t-loading\n        v-if=\"typeof asyncLoading === 'string' && ['loading', 'load-more'].includes(asyncLoading)\"\n        :loading=\"asyncLoading === 'loading'\"\n        :text=\"typeof asyncLoading === 'string' ? LOADING_TEXT_MAP[asyncLoading] : ''\"\n        :class=\"`${name}__loading`\"\n      />\n    </div>\n    <t-node :content=\"footerContent\" />\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, ref, computed, getCurrentInstance, SetupContext } from 'vue';\nimport { useElementBounding, useWindowSize, useEventListener } from '@vueuse/core';\nimport TLoading from '../loading';\nimport config from '../config';\nimport ListProps from './props';\nimport { renderTNode, TNode, useScrollParent, useEmitEvent } from '../shared';\n\nconst { prefix } = config;\nconst name = `${prefix}-list`;\nconst LOADING_TEXT_MAP = {\n  loading: '加载中...',\n  'load-more': '点击加载更多',\n};\n\nexport default defineComponent({\n  name,\n  components: {\n    TLoading,\n    TNode,\n  },\n  props: ListProps,\n  emits: ['load-more', 'scroll'],\n  setup(props, context: SetupContext) {\n    const emitEvent = useEmitEvent(props, context.emit);\n    const root = ref<HTMLElement>();\n    const empty = ref<HTMLElement>();\n    const scrollParent = useScrollParent(root);\n    const { height } = useWindowSize();\n    const internalInstance = getCurrentInstance();\n\n    const headerContent = computed(() => renderTNode(internalInstance, 'header'));\n    const footerContent = computed(() => renderTNode(internalInstance, 'footer'));\n\n    const onLoadMore = (e: MouseEvent) => {\n      if (props.asyncLoading === 'load-more') {\n        emitEvent('load-more');\n      }\n    };\n\n    const handleScroll = (e: WheelEvent | Event) => {\n      const { top } = useElementBounding(root);\n\n      emitEvent('scroll', top.value - height.value, document.documentElement.scrollTop);\n    };\n\n    useEventListener(scrollParent, 'scroll', handleScroll);\n\n    return {\n      name,\n      root,\n      empty,\n      onLoadMore,\n      handleScroll,\n      headerContent,\n      footerContent,\n      LOADING_TEXT_MAP,\n    };\n  },\n});\n</script>\n","<template>\n  <div ref=\"root\" :class=\"name\" @scroll=\"handleScroll\">\n    <t-node :content=\"headerContent\" />\n    <slot />\n    <div :class=\"`${name}__loading--wrapper`\" @click.stop=\"onLoadMore\">\n      <t-loading\n        v-if=\"typeof asyncLoading === 'string' && ['loading', 'load-more'].includes(asyncLoading)\"\n        :loading=\"asyncLoading === 'loading'\"\n        :text=\"typeof asyncLoading === 'string' ? LOADING_TEXT_MAP[asyncLoading] : ''\"\n        :class=\"`${name}__loading`\"\n      />\n    </div>\n    <t-node :content=\"footerContent\" />\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, ref, computed, getCurrentInstance, SetupContext } from 'vue';\nimport { useElementBounding, useWindowSize, useEventListener } from '@vueuse/core';\nimport TLoading from '../loading';\nimport config from '../config';\nimport ListProps from './props';\nimport { renderTNode, TNode, useScrollParent, useEmitEvent } from '../shared';\n\nconst { prefix } = config;\nconst name = `${prefix}-list`;\nconst LOADING_TEXT_MAP = {\n  loading: '加载中...',\n  'load-more': '点击加载更多',\n};\n\nexport default defineComponent({\n  name,\n  components: {\n    TLoading,\n    TNode,\n  },\n  props: ListProps,\n  emits: ['load-more', 'scroll'],\n  setup(props, context: SetupContext) {\n    const emitEvent = useEmitEvent(props, context.emit);\n    const root = ref<HTMLElement>();\n    const empty = ref<HTMLElement>();\n    const scrollParent = useScrollParent(root);\n    const { height } = useWindowSize();\n    const internalInstance = getCurrentInstance();\n\n    const headerContent = computed(() => renderTNode(internalInstance, 'header'));\n    const footerContent = computed(() => renderTNode(internalInstance, 'footer'));\n\n    const onLoadMore = (e: MouseEvent) => {\n      if (props.asyncLoading === 'load-more') {\n        emitEvent('load-more');\n      }\n    };\n\n    const handleScroll = (e: WheelEvent | Event) => {\n      const { top } = useElementBounding(root);\n\n      emitEvent('scroll', top.value - height.value, document.documentElement.scrollTop);\n    };\n\n    useEventListener(scrollParent, 'scroll', handleScroll);\n\n    return {\n      name,\n      root,\n      empty,\n      onLoadMore,\n      handleScroll,\n      headerContent,\n      footerContent,\n      LOADING_TEXT_MAP,\n    };\n  },\n});\n</script>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}