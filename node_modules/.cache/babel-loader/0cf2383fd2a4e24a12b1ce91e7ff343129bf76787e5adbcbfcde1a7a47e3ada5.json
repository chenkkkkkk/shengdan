{"ast":null,"code":"/**\n * tdesign v0.14.1\n * (c) 2022 TDesign Group\n * @license MIT\n */\n\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport _asyncToGenerator from '@babel/runtime/helpers/asyncToGenerator';\nimport _regeneratorRuntime from '@babel/runtime/regenerator';\nimport { sleep } from '../util.js';\nfunction useTestUtils() {\n  var makeScroll = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(dom, name, offset) {\n      var eventTarget, evt;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              eventTarget = dom === document.documentElement ? window : dom;\n              dom[name] = offset;\n              evt = new CustomEvent(\"scroll\", {\n                detail: {\n                  target: _defineProperty({}, name, offset)\n                }\n              });\n              eventTarget.dispatchEvent(evt);\n              _context.next = 6;\n              return sleep(0);\n            case 6:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n    return function makeScroll(_x, _x2, _x3) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n  return {\n    makeScroll: makeScroll,\n    sleep: sleep\n  };\n}\nfunction useVitest(vi) {\n  var getBoundingClientRect = function getBoundingClientRect(dom) {\n    return vi.spyOn(dom, \"getBoundingClientRect\");\n  };\n  return {\n    getBoundingClientRect: getBoundingClientRect\n  };\n}\nexport { useTestUtils, useVitest };","map":{"version":3,"mappings":";;;;;;;;;;AAKO,SAASA,YAAe;EAC7B,IAAMC,UAAa;IAAA,6EAAOC,WAAc,QAAkCC,MAAmB;MAAA;MAAA;QAAA;UAAA;YAAA;cACrFC,WAAc,WAAQC,QAAS,mBAAkBC,MAAS;cAChEJ,IAAIK,IAAQ;cACNC,MAAM,IAAIC,YAAY,QAAU;gBACpCC,MAAQ;kBACNC,MAAQ,sBACLJ,IAAO;gBAEZ;cACF,CAAC;cACDH,YAAYQ,cAAcJ,GAAG;cAAAK;cAAA,OAEvBC,MAAM,CAAC;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;KACf;IAAA,gBAbMb,UAAa;MAAA;IAAA;GAanB;EAEO;IAAEA;IAAYa,KAAM,EAANA;GAAM;AAC7B;AAKO,SAASC,UAAUC,EAAuC;EAC/D,IAAMC,wBAAwB,SAAxBA,sBAAyBf;IAAA,OAAiBc,EAAG,OAAMd,KAAK,uBAAuB;EAAA;EAErF,OAAO;IAAEe,qBAAsB,EAAtBA;GAAsB;AACjC","names":["useTestUtils","makeScroll","dom","offset","eventTarget","document","window","name","evt","CustomEvent","detail","target","dispatchEvent","_context","sleep","useVitest","vi","getBoundingClientRect"],"sources":["../../../src/shared/useTest/index.ts"],"sourcesContent":["import { sleep } from '../util';\n\n/**\n * 测试相关的工具方法\n */\nexport function useTestUtils() {\n  const makeScroll = async (dom: Element, name: 'scrollTop' | 'scrollLeft', offset: number) => {\n    const eventTarget = dom === document.documentElement ? window : dom;\n    dom[name] = offset;\n    const evt = new CustomEvent('scroll', {\n      detail: {\n        target: {\n          [name]: offset,\n        },\n      },\n    });\n    eventTarget.dispatchEvent(evt);\n    // must use setTimeout instead of nextTick to wait dom change\n    await sleep(0);\n  };\n\n  return { makeScroll, sleep };\n}\n\n/**\n * 测试相关的vitest方法\n */\nexport function useVitest(vi: typeof import('vitest')['vitest']) {\n  const getBoundingClientRect = (dom: Element) => vi.spyOn(dom, 'getBoundingClientRect');\n\n  return { getBoundingClientRect };\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}